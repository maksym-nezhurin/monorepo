# monorepo
# Monorepo Microservice Application

## –û–ø–∏—Å

–¶–µ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π ‚Äî **–º–æ–Ω–æ—Ä–µ–ø–æ** –¥–ª—è –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–Ω–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –∑ –Ω–∞—Å—Ç—É–ø–Ω–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é:

monorepo/
‚îú‚îÄ‚îÄ apps/ # Frontend –¥–æ–¥–∞—Ç–∫–∏
‚îÇ ‚îú‚îÄ‚îÄ client/ # Next.js –∫–ª—ñ—î–Ω—Ç
‚îÇ ‚îî‚îÄ‚îÄ admin/ # React –∞–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å
‚îú‚îÄ‚îÄ config/
‚îÇ ‚îî‚îÄ‚îÄ env/
‚îÇ ‚îî‚îÄ‚îÄ .env.template # –®–∞–±–ª–æ–Ω –¥–ª—è .env —Ñ–∞–π–ª—ñ–≤
‚îú‚îÄ‚îÄ infrastructure/
‚îÇ ‚îî‚îÄ‚îÄ keycloak/ # Keycloak —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
‚îú‚îÄ‚îÄ services/ # Backend –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∏
‚îÇ ‚îú‚îÄ‚îÄ auth/
‚îÇ ‚îú‚îÄ‚îÄ user/
‚îÇ ‚îú‚îÄ‚îÄ notification/
‚îÇ ‚îî‚îÄ‚îÄ gateway/
‚îú‚îÄ‚îÄ scripts/ # –°—Ü–µ–Ω–∞—Ä—ñ—ó –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó
‚îÇ ‚îú‚îÄ‚îÄ setup.sh # –û—Å–Ω–æ–≤–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∫–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –ø—Ä–æ–µ–∫—Ç—É
‚îÇ ‚îú‚îÄ‚îÄ import-realm.sh # –°–∫—Ä–∏–ø—Ç —ñ–º–ø–æ—Ä—Ç—É realm –¥–æ Keycloak
‚îÇ ‚îî‚îÄ‚îÄ (—ñ–Ω—à—ñ —Å–∫—Ä–∏–ø—Ç–∏)
‚îú‚îÄ‚îÄ docker-compose.yml # –û—Å–Ω–æ–≤–Ω–∏–π Docker Compose –¥–ª—è –∑–∞–ø—É—Å–∫—É —É—Å—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤
‚îî‚îÄ‚îÄ README.md # –¶–µ–π —Ñ–∞–π–ª

markdown
Copy
Edit

---

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

- **Keycloak** ‚Äî —Å–µ—Ä–≤–µ—Ä –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–∏–π –≤ `infrastructure/keycloak`.
- **Frontend:**
  - `apps/client` ‚Äî Next.js –∫–ª—ñ—î–Ω—Ç.
  - `apps/admin` ‚Äî React –∞–¥–º—ñ–Ω–∫–∞.
- **Backend:**
  - –†—ñ–∑–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ (`auth`, `user`, `notification`, `gateway`) –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ `services`.
- **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è:**
  - –ó–∞–≥–∞–ª—å–Ω—ñ `.env.template` –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ `config/env`.
- **–°—Ü–µ–Ω–∞—Ä—ñ—ó:**
  - –°–∫—Ä–∏–ø—Ç–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –∫–ª–æ–Ω—É–≤–∞–Ω–Ω—è, –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó `.env` —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å.

---

## –Ø–∫ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø—Ä–æ–µ–∫—Ç–æ–º

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ `setup.sh` –¥–ª—è –∫–ª–æ–Ω—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è `.env` —Ñ–∞–π–ª—ñ–≤:

```bash
./scripts/setup.sh
–¶–µ–π —Å–∫—Ä–∏–ø—Ç:

–ö–ª–æ–Ω—É—î –≤—Å—ñ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø—ñ–¥–ø—Ä–æ–µ–∫—Ç–∏ —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –ø–∞–ø–∫–∏

–ö–æ–ø—ñ—é—î —à–∞–±–ª–æ–Ω .env.template –≤ .env —É –∫–æ–∂–Ω–æ–º—É —Å–µ—Ä–≤—ñ—Å—ñ, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ —Ç–∞ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ñ

2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –∑ Docker Compose
–ó–∞–ø—É—Å–∫–∞—î–º–æ –≤—Å—ñ —Å–µ—Ä–≤—ñ—Å–∏ (Keycloak, backend, frontend):

bash
Copy
Edit
docker-compose up -d
3. –Ü–º–ø–æ—Ä—Ç Realm –≤ Keycloak
Keycloak –ø—ñ–¥—Ç—Ä–∏–º—É—î —ñ–º–ø–æ—Ä—Ç realm –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —á–µ—Ä–µ–∑ –æ–ø—Ü—ñ—é --import-realm —É Docker Compose.

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ realm –≤—Ä—É—á–Ω—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—ñ—Å–ª—è —Å—Ç–∞—Ä—Ç—É Keycloak), –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Å–∫—Ä–∏–ø—Ç:

bash
Copy
Edit
./scripts/import-realm.sh
–¶–µ–π —Å–∫—Ä–∏–ø—Ç:

–ß–µ–∫–∞—î –ø–æ–∫–∏ Keycloak –ø—ñ–¥–Ω—ñ–º–µ—Ç—å—Å—è

–õ–æ–≥—ñ–Ω–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ Keycloak Admin CLI

–Ü–º–ø–æ—Ä—Ç—É—î realm –∑ —Ñ–∞–π–ª—É infrastructure/keycloak/realm-export.json

4. –†–æ–∑—Ä–æ–±–∫–∞ —Ç–∞ –ø—Ä–æ–¥–∞–∫—à–Ω
–î–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏ –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å–∫–∞—Ç–∏ —Å–µ—Ä–≤—ñ—Å–∏ –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º docker-compose.override.yml, –¥–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π hot-reload —Ç–∞ –ª–æ–∫–∞–ª—å–Ω—ñ —Ç–æ–º–∏.

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω ‚Äî –±–∞–∑–æ–≤–∏–π docker-compose.yml –∑ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–º–∏ –æ–±—Ä–∞–∑–∞–º–∏.

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ Docker Compose
–ö–æ–∂–µ–Ω —Å–µ—Ä–≤—ñ—Å ‚Äî –æ–∫—Ä–µ–º–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

Keycloak —è–∫ –æ–∫—Ä–µ–º–∏–π —Å–µ—Ä–≤—ñ—Å

Frontend —Ç–∞ backend –ø—ñ–¥–∫–ª—é—á–µ–Ω—ñ –¥–æ —Å–ø—ñ–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ myapp-network

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è volume –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö Keycloak (keycloak_data)

–ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏
–û–Ω–æ–≤–∏—Ç–∏ –∫–æ–¥ —ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è .env:

bash
Copy
Edit
./scripts/setup.sh
–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≤—Å—ñ —Å–µ—Ä–≤—ñ—Å–∏:

bash
Copy
Edit
docker-compose up -d
–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏ Keycloak:

bash
Copy
Edit
docker-compose logs -f keycloak
–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ realm –≤—Ä—É—á–Ω—É:

bash
Copy
Edit
./scripts/import-realm.sh
–ö–æ–Ω—Ç–∞–∫—Ç–∏ —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞
–Ø–∫—â–æ –≤–∏–Ω–∏–∫–Ω—É—Ç—å –ø–∏—Ç–∞–Ω–Ω—è, –∑–≤–µ—Ä—Ç–∞–π—Ç–µ—Å—å –¥–æ –∞–≤—Ç–æ—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É ‚Äî –ú–∞–∫—Å–∏–º –ù–µ–∂—É—Ä—ñ–Ω.

üîß docker-compose.yml (Production) 

üîß docker-compose.dev.yml (Development) –∑ –•–æ—Ç —Ö–æ—Ç—Ä–µ–ª–æ–∞–¥–∞–º–∏

### –ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—ñ–¥–Ω—è—Ç—Ç—è –ö–µ–π–∫–ª–æ–∫–∞ –º–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –†–µ–∞–ª–º –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∫—Ä–∏–ø—Ç–∞

–Ø–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è
–ó–±–µ—Ä–µ–∂–∏ —Å–∫—Ä–∏–ø—Ç, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —É —Ñ–∞–π–ª create-realm.sh

–î–∞–π –ø—Ä–∞–≤–∞ –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:

chmod +x create-realm.sh

–ó–∞–ø—É—Å—Ç–∏:

./create-realm.sh my-new-realm

–©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ:
jq –º–∞—î –±—É—Ç–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π (sudo apt install jq –∞–±–æ —á–µ—Ä–µ–∑ brew –¥–ª—è macOS)

Keycloak –º–∞—î –±—É—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ http://localhost:8080

admin —ñ –ø–∞—Ä–æ–ª—å admin ‚Äî –∞–±–æ —Å–≤–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –∫—Ä–µ–¥–µ–Ω—à—ñ–∞–ª–∏ –≤ —Å–∫—Ä–∏–ø—Ç—ñ

–°–∫—Ä–∏–ø—Ç –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —Ä–µ–∞–ª–º—ñ
chmod +x create-realm-user.sh
./create-realm-user.sh application john_doe john@example.com test